{% form_theme form _self %}
{% extends 'base.html.twig' %}
{% block title %}Hello DefaultController!{% endblock %}
{% block body %}

    {{ path('city', {"country": 148, "state" : 2504}) }}


    {{ form_start(form) }}
    <fieldset>
        {{ form_row(form) }}
    </fieldset>
    <button type="submit" class="btn btn-success">
        Go
    </button>
    {{ form_end(form) }}
{% endblock %}
{% block form_row %}
    <div class="form-group">
        {{ form_label(form) }}
        <div class="col-sm-10">
            {{ form_widget(form) }}
            {{ form_errors(form) }}
        </div>
    </div>
{% endblock %}
{% block form_label %}
    <label for="{{ id }}">{{ label }}</label>
{% endblock %}
{% block textarea_widget %}
    <textarea class="form-control" id="{{ id }}" name="{{ name }}">
        {{ value }}
    </textarea>
{% endblock %}
{% block text_widget %}
    <input type="text" class="form-control" id="{{ id }}" value="{{ value }}" name="{{ name }}"/>
{% endblock %}
{% block choice_widget %}
    <select class="form-control" name="{{ name }}" id="{{ id }}">
        {%- if placeholder is not none -%}
            <option value=""{% if required and value is empty %} selected="selected"{% endif %}>
                {{ placeholder != '' ? (translation_domain is same as(false) ? placeholder : placeholder|trans({}, translation_domain)) }}
            </option>
        {%- endif -%}
        {% for choice in choices %}
            <option value="{{ choice.value }}">
                {{ choice.label }}
            </option>
        {% endfor %}
    </select>
{% endblock %}
{% block javascripts %}
<script type="text/javascript">
    $(document).ready(function () {
        $('#shipping_country').on('change', function () {
            var $value = $(this).val();
            var $states = $("#shipping_state");
            $.ajax({
                url: "/state/"+$value,
                dataType: 'json',
                beforeSend: function () {
                    $states.find("option:not(:first)").remove();
                },
                success: function (data) {
                    $.each(data, function (i, item) {
                        $states.append(new Option(item.name, item.id));
                    });
                }
            });
        });


        $('#shipping_state').on('change', function () {
            var $country = $('#shipping_country').val();
            var $value = $(this).val();
            var $cities = $("#shipping_city");
            $.ajax({
                url: "/country/"+$country+'/cities/'+$value,
                dataType: 'json',
                beforeSend: function () {
                    $cities.find("option:not(:first)").remove();
                },
                success: function (data) {
                    $.each(data, function (i, item) {
                        $cities.append(new Option(item.name, item.id));
                    });
                }
            });
        });
    });
</script>
{% endblock %}